(this.webpackJsonpldklc=this.webpackJsonpldklc||[]).push([[0],{192:function(e,t,a){},193:function(e,t,a){},218:function(e,t,a){},279:function(e,t,a){},324:function(e,t,a){},327:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(27),c=a.n(s),i=(a(192),a(8)),o=a(9),l=a(13),u=a(14),d=(a(193),a(185)),h=a(37),p=a(39),j=a(32),b=a(20),m=a.n(b),f=a(44),O=a.n(f),x="AUTH_SUCCESS",g="AUTH_START",v="AUTH_FAILED",y="AUTH_LOGOUT",w=function(e){return localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("expires"),e?{type:y,payload:{isAuth:!1,alert:e}}:{type:y,payload:{isAuth:!1,alert:null}}},k=function(e){return function(t){setTimeout((function(){t(w("your session timed out. Please login again!"))}),e)}},S=function(e,t){return function(){var a=Object(j.a)(m.a.mark((function a(n){var r,s,c;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:g,loading:!0}),a.prev=1,a.next=4,O.a.post(e,t);case 4:r=a.sent,s=r.data,c=new Date((new Date).getTime()+s.data.expires),localStorage.setItem("token",s.data.token),localStorage.setItem("userId",s.data.id),localStorage.setItem("expires",c),n({type:x,payload:{isAuth:!0,token:s.data.token,userId:s.data.id,loading:!1}}),n(k(s.data.expires)),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(1),n({type:v,payload:{error:a.t0.response.data.message}});case 17:case"end":return a.stop()}}),a,null,[[1,14]])})));return function(e){return a.apply(this,arguments)}}()},_=a(6);var I=Object(h.b)((function(e){return{isAuth:e.auth.isAuth}}),(function(e){return{logout:function(){return e(w())}}}))((function(e){return Object(_.jsxs)("div",{className:"main-nav",children:[Object(_.jsx)("div",{className:"logo",style:{cursor:"pointer"},children:Object(_.jsx)(p.b,{to:"/",children:Object(_.jsx)("h3",{style:{color:"rgb(226, 116, 13)"},children:"Qfeed"})})}),Object(_.jsxs)("ul",{className:"nav-list",children:[e.isAuth?Object(_.jsx)(p.b,{to:"/share",children:Object(_.jsx)("li",{className:"nav-list__item",children:Object(_.jsx)(d.a,{style:{color:"white",fontSize:"20px"}})})}):null,e.isAuth?Object(_.jsx)("li",{className:"nav-list__item",onClick:function(t){e.logout()},style:{cursor:"pointer"},children:"Logout"}):Object(_.jsx)(p.b,{to:"/signup",children:Object(_.jsx)("li",{className:"nav-list__item",children:"Sign Up"})})]})]})})),A=a(28),U=a(333),L=function(e){var t=U.a.Search;return Object(_.jsx)("div",{className:"feed-list_filters border_radius",children:Object(_.jsx)(t,{placeholder:"input search text",allowClear:!0,enterButton:"Search",size:"large",onSearch:function(t){e.onSearch(t)}})})},N=(a(218),a(174)),C=a(330),T=a(49),H=function(e){return Object(_.jsx)("div",{className:"loading-body border_radius",children:Object(_.jsx)(T.a,{style:{fontSize:"15px"}})})},D=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,feed:[],page:1,hasMore:!0,search:null,notfound:!1},e.componentDidMount=Object(j.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get("http://35.170.82.230:5000/api/feed");case 2:a=t.sent,n=a.data,e.setState({feed:n.feeds});case 5:case"end":return t.stop()}}),t)}))),e.fetchMoreData=Object(j.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({page:e.state.page+1}),t.next=3,O.a.get("http://35.170.82.230:5000/api/feed?page="+e.state.page);case 3:a=t.sent,n=a.data,e.setState({feed:e.state.feed.concat(n.feeds)}),0===n.feeds.length&&e.setState({hasMore:!1});case 7:case"end":return t.stop()}}),t)}))),e.searchHandler=function(){var t=Object(j.a)(m.a.mark((function t(a){var n,r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==e.state.search){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,O.a.get("http://35.170.82.230:5000/api/feed/search/"+a);case 4:n=t.sent,r=n.data,e.setState({feed:r.feeds}),0===e.state.feed.length&&e.setState({notfound:!0});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(o.a)(a,[{key:"render",value:function(){var e=Object(_.jsx)(H,{});return 0!==this.state.feed.length&&null===this.state.search&&(e=Object(_.jsx)(N.a,{dataLength:this.state.feed.length,next:this.fetchMoreData,hasMore:this.state.hasMore,loader:Object(_.jsx)("h4",{children:".."}),children:this.state.feed.map((function(e){return Object(_.jsx)(p.b,{to:"/".concat(e._id),className:"feed_card ",style:{borderRadius:"12px"},children:Object(_.jsxs)(C.a,{title:e.subject+"-"+e.type,className:"border_radius",style:{marginBottom:"12px",marginTop:"20px"},children:[Object(_.jsx)("div",{children:e.docUrl&&Object(_.jsx)("img",{src:e.docUrl,width:"100%",alt:"..."})}),Object(_.jsx)("p",{style:{marginTop:"15px"},children:e.title+"  "})]})},e._id)}))})),this.state.search&&(e=this.state.feed.map((function(e){return Object(_.jsx)(p.b,{to:"/".concat(e._id),className:"feed_card",style:{borderRadius:"12px"},children:Object(_.jsxs)(C.a,{title:e.subject+"-"+e.type,style:{marginBottom:"12px",marginTop:"20px"},children:[Object(_.jsx)("div",{children:e.docUrl&&Object(_.jsx)("img",{src:e.docUrl,width:"100%",alt:"..."})}),Object(_.jsx)("p",{style:{marginTop:"15px"},children:e.title+"  "})]})},e._id)}))),Object(_.jsxs)("div",{className:"feed-list",children:[Object(_.jsx)(L,{onSearch:this.searchHandler}),e]})}}]),a}(n.Component),P=D,q=a(3),F=a(7),M=(a(279),a(328)),B=a(329),z=a(56),Q=a(331),R=a(335),E=a(337),J=a(334),G=function(e){return Object(_.jsx)(J.a,{centered:!0,visible:e.visible,onCancel:e.toggle,footer:[],children:Object(_.jsx)("div",{children:Object(_.jsx)("img",{src:e.docUrl,alt:"",style:{width:"100%"}})})})},V=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={feed:{},fileList:[],visible:!1,docUrl:null},e.componentDidMount=Object(j.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.a.get("http://35.170.82.230:5000/api/feed/"+e.props.match.params.id);case 2:a=t.sent,n=a.data,e.setState({feed:n.feed});case 5:case"end":return t.stop()}}),t)}))),e.uploadHandler=function(){var t=Object(j.a)(m.a.mark((function t(a){var n,r,s,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={},(r=new FormData).append("files",e.state.fileList[0]),t.next=6,O.a.post("http://34.238.193.147:4000/",r);case 6:return s=t.sent,c=s.data,n.docUrl="http://34.238.193.147:4000/uploads/"+c.imageLink,t.next=11,O.a.post("http://35.170.82.230:5000/api/feed/"+e.props.match.params.id+"/comment",n,{headers:{Authorization:"Bearer ".concat(e.props.token)}});case 11:window.location.reload(),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.log(t.t0.response);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}(),e.showImage=function(t){e.setState({visible:!0,docUrl:t})},e.toggle=function(){e.setState({visible:!e.state.visible})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t={onRemove:function(t){e.setState((function(e){var a=e.fileList.indexOf(t),n=e.fileList.slice();return n.splice(a,1),{fileList:n}}))},beforeUpload:function(t){return e.setState((function(e){return{fileList:[].concat(Object(F.a)(e.fileList),[t])}})),!1},fileList:this.state.fileList.fileList};return Object(_.jsxs)("div",{className:"single_feed",children:[Object(_.jsx)(G,{docUrl:this.state.docUrl,visible:this.state.visible,toggle:this.toggle}),this.state.feed.content&&Object(_.jsx)("div",{className:"content",dangerouslySetInnerHTML:{__html:this.state.feed.content}}),this.state.feed.docUrl&&Object(_.jsx)("div",{className:"single__feed-image",children:Object(_.jsx)("img",{src:this.state.feed.docUrl,alt:""})}),Object(_.jsx)(M.a,{}),this.state.feed.docUrl&&Object(_.jsxs)("div",{children:[Object(_.jsxs)("div",{className:"answer_img",children:[Object(_.jsx)(B.a,Object(q.a)(Object(q.a)({},t),{},{children:Object(_.jsx)(z.a,{icon:Object(_.jsx)(E.a,{}),children:"Upload your answer"})})),Object(_.jsx)(z.a,{style:{marginTop:"23px"},onClick:this.uploadHandler,children:"Submit"})]}),Object(_.jsx)(M.a,{}),Object(_.jsxs)("h2",{children:["Answers ",this.state.feed.comments.length]}),Object(_.jsx)("div",{className:"comments",children:Object(_.jsx)(Q.b,{bordered:!0,children:this.state.feed.comments.map((function(t,a){return Object(_.jsx)(Q.b.Item,{actions:[Object(_.jsx)(z.a,{onClick:function(){return e.showImage(t.docUrl)},children:"View"},"list-loadmore-edit")],children:Object(_.jsx)(R.a,{avatar:!0,title:!1,loading:t.loading,active:!0,children:Object(_.jsx)(Q.b.Item.Meta,{avatar:Object(_.jsx)("h3",{children:a+1})})})},a)}))})})]})]})}}]),a}(n.Component),K=Object(h.b)((function(e){return{token:e.auth.token}}))(V),W=a(93),X=a(332),Y=a(94),Z=a.n(Y),$=a(184);Y.Quill.register("modules/imageUploader",$.a);var ee=function(e){var t=Y.Quill.import("formats/image");t.className="quill-image",Y.Quill.register(t,!0);var a={toolbar:[["bold","italic","image"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{header:[1,2,3,4,5,6,!1]}]],imageUploader:{upload:function(e){return new Promise((function(t,a){var n=new FormData;n.append("files",e),fetch("http://localhost:4000/",{method:"POST",body:n}).then((function(e){return e.json()})).then((function(e){console.log(e),t("http://localhost:4000/uploads/"+e.imageLink)})).catch((function(e){a("Upload failed"),console.error("Error:",e)}))}))}}};return Object(_.jsx)(Z.a,{theme:"snow",modules:a,formats:["header","bold","italic","underline","strike","blockquote","code-block","list","bullet","indent","link","image","imageBlot"],value:e.editorHtml,onChange:e.onChange})},te=(a(324),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={editorHtml:"",current:"article",fileList:[]},e.rteChange=function(e,t,a,n){localStorage.setItem("html",n.getHTML())},e.componentDidMount=function(){e.setState({editorHtml:localStorage.getItem("html")})},e.handleClick=function(t,a){e.setState({current:a})},e.onFinishHandler=function(){var t=Object(j.a)(m.a.mark((function t(a){var n,r,s,c,i,o,l;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=e.state.fileList,r=Object(q.a)({},a),"question"!==e.state.current){t.next=14;break}return(s=new FormData).append("files",n[0]),t.next=8,O.a.post("http://34.238.193.147:4000/",s);case 8:c=t.sent,i=c.data,r.docUrl="http://34.238.193.147:4000/uploads/"+i.imageLink,r.type="question",t.next=16;break;case 14:r.content=e.state.editorHtml,r.type="article";case 16:return t.next=18,O.a.post("http://35.170.82.230:5000/api/feed",r,{headers:{Authorization:"Bearer ".concat(e.props.token)}});case 18:o=t.sent,l=o.data,console.log(l),e.props.history.push("/"),t.next=26;break;case 24:t.prev=24,t.t0=t.catch(0);case 26:case"end":return t.stop()}}),t,null,[[0,24]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=W.a.Option,a=["math","physics","cs","chemistry"].map((function(e){return Object(_.jsx)(t,{value:e,children:e},e)})),n={onRemove:function(t){e.setState((function(e){var a=e.fileList.indexOf(t),n=e.fileList.slice();return n.splice(a,1),{fileList:n}}))},beforeUpload:function(t){return e.setState((function(e){return{fileList:[].concat(Object(F.a)(e.fileList),[t])}})),!1},fileList:this.state.fileList.fileList};return Object(_.jsxs)("div",{className:"sharepage",children:[Object(_.jsx)("div",{className:"sharepage__content",style:{marginBottom:"23px",padding:"12px"},children:Object(_.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(_.jsx)(z.a,{type:"primary",onClick:function(t){return e.handleClick(t,"article")},children:"Article"}),Object(_.jsx)(z.a,{onClick:function(t){return e.handleClick(t,"question")},children:"Question"})]})}),"question"===this.state.current&&Object(_.jsx)("div",{className:"sharepage__content",style:{padding:"15px"},children:Object(_.jsx)(B.a,Object(q.a)(Object(q.a)({},n),{},{children:Object(_.jsx)(z.a,{icon:Object(_.jsx)(E.a,{}),children:"Click to Upload"})}))}),Object(_.jsx)("div",{className:"sharepage__content",children:Object(_.jsxs)(X.a,{onFinish:this.onFinishHandler,children:[Object(_.jsx)(X.a.Item,{label:"title",name:"title",rules:[{required:!0,message:"Please input the title!"}],className:"sharepage__content",style:{marginTop:"23px"},children:Object(_.jsx)(U.a,{})}),Object(_.jsx)(X.a.Item,{label:"subject",name:"subject",rules:[{required:!0,message:"Please select subject"}],className:"sharepage__content",style:{marginTop:"23px"},children:Object(_.jsx)(W.a,{children:a})}),Object(_.jsx)(X.a.Item,{wrapperCol:{offset:8,span:16},children:Object(_.jsx)(z.a,{type:"primary",htmlType:"submit",style:{marginBottom:"12px"},children:"Publish"})})]})}),"article"===this.state.current&&Object(_.jsx)(ee,{editorHtml:this.state.editorHtml,onChange:this.rteChange,className:"sharepage__content"})]})}}]),a}(n.Component)),ae=Object(h.b)((function(e){return{token:e.auth.token}}))(te),ne=a(336),re=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(t){e.props.auth("http://35.170.82.230:5000/api/auth/signup",t),e.props.history.push("/")},e}return Object(o.a)(a,[{key:"render",value:function(){return Object(_.jsx)("div",{className:"auth_page",children:Object(_.jsxs)("div",{className:"auth_container",children:[this.props.error?Object(_.jsx)(ne.a,{message:this.props.error,type:"warning",showIcon:!0,closable:!0}):null,Object(_.jsxs)(X.a,{onFinish:this.onFinish,style:{marginTop:"12px"},children:[Object(_.jsx)(X.a.Item,{label:"Username",name:"name",rules:[{required:!0,message:"Please input your username!"}],children:Object(_.jsx)(U.a,{})}),Object(_.jsx)(X.a.Item,{label:"email",name:"email",rules:[{type:"email",required:!0,message:"Please input your username!"}],children:Object(_.jsx)(U.a,{})}),Object(_.jsx)(X.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password, minimum 6 characters!",min:6}],children:Object(_.jsx)(U.a.Password,{})}),Object(_.jsx)(X.a.Item,{wrapperCol:{offset:8,span:16},children:Object(_.jsx)(z.a,{type:"primary",htmlType:"submit",children:"Sign Up"})})]}),Object(_.jsxs)("p",{children:["Arleady have an account ",Object(_.jsx)(p.b,{to:"/login",children:"Login"})]})]})})}}]),a}(n.Component),se=Object(h.b)((function(e){return{error:e.auth.error}}),(function(e){return{auth:function(t,a){return e(S(t,a))}}}))(re),ce=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(t){e.props.auth("http://35.170.82.230:5000/api/auth/login",t),e.props.history.push("/")},e}return Object(o.a)(a,[{key:"render",value:function(){return Object(_.jsx)("div",{className:"auth_page",children:Object(_.jsxs)("div",{className:"auth_container",children:[this.props.error?Object(_.jsx)(ne.a,{message:this.props.error,type:"warning",showIcon:!0,closable:!0}):null,Object(_.jsxs)(X.a,{onFinish:this.onFinish,style:{marginTop:"12px"},children:[Object(_.jsx)(X.a.Item,{label:"email",name:"email",rules:[{type:"email",required:!0,message:"Please input your username!"}],children:Object(_.jsx)(U.a,{})}),Object(_.jsx)(X.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password, minimum 6 characters!",min:6}],children:Object(_.jsx)(U.a.Password,{})}),Object(_.jsx)(X.a.Item,{wrapperCol:{offset:8,span:16},children:Object(_.jsx)(z.a,{type:"primary",htmlType:"submit",children:"Login"})})]}),Object(_.jsxs)("p",{children:["Dont have an account ",Object(_.jsx)(p.b,{to:"/signup",children:"Sign Up"})]})]})})}}]),a}(n.Component),ie=Object(h.b)((function(e){return{error:e.auth.error}}),(function(e){return{auth:function(t,a){return e(S(t,a))}}}))(ce),oe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).componentDidMount=function(){e.props.checkAuth()},e}return Object(o.a)(a,[{key:"render",value:function(){return Object(_.jsxs)("div",{className:"main-layout",children:[Object(_.jsx)(I,{}),Object(_.jsx)("div",{className:"content",children:Object(_.jsxs)(A.c,{children:[this.props.isAuth?Object(_.jsx)(A.a,{path:"/share",component:ae}):null,this.props.isAuth?null:Object(_.jsx)(A.a,{path:"/login",component:ie}),this.props.isAuth?null:Object(_.jsx)(A.a,{path:"/signup",component:se}),Object(_.jsx)(A.a,{path:"/:id",component:K}),Object(_.jsx)(A.a,{path:"/",component:P})]})})]})}}]),a}(r.a.Component),le=Object(h.b)((function(e){return{isAuth:e.auth.isAuth}}),(function(e){return{checkAuth:function(){return e((function(e){var t=localStorage.getItem("token"),a=localStorage.getItem("userId");if(console.log("authenticating"),t&&a){var n=new Date(localStorage.getItem("expires"));new Date>=n?e(w()):(e({type:x,payload:{isAuth:!0,token:t,userId:a}}),e(k(n.getTime()-(new Date).getTime())))}else e(w())}))}}}))(oe),ue=(a(325),a(95)),de=a(178),he={token:null,expires:null,loading:!1,userId:null,isAuth:!1,error:null},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:case x:case v:case y:return Object(q.a)({state:e},t.payload);default:return e}},je=(a(326),ue.c),be=Object(ue.b)({auth:pe}),me=Object(ue.d)(be,je(Object(ue.a)(de.a)));c.a.render(Object(_.jsx)(h.a,{store:me,children:Object(_.jsx)(p.a,{children:Object(_.jsx)(le,{})})}),document.getElementById("root"))}},[[327,1,2]]]);
//# sourceMappingURL=main.4ca163d4.chunk.js.map